<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New Journal Entry</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='menu.css') }}">
    
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-logo">DailyPlournal</div>

        <div class="profile-section">
            <a href="profile.html" class="profile-link">
                <div class="profile-icon"></div>
            </a>
            <input type="text" class="name-field" placeholder="Name">
            <div class="interactive-elements">
                <div class="interactive-element"></div>
                <div class="interactive-element"></div>
            </div>
            <div class="streak-counter">Streak: <span id="streakCount">0</span> days</div>
        </div>

       <nav class="sidebar-nav">
            <ul>
                <li><a href="{{ url_for('home') }}">Home</a></li>
                <li>
                    <a href="{{ url_for('new_journal_entry') }}" id="write-link">Write</a>
                    <ul>
                        <li><a href="journaleditor.html">Edit</a></li>
                        <li><a href="journaleditor.html">View</a></li>
                    </ul>
                </li>
                <li><a href="{{ url_for('home') }}">Log Out</a></li>
            </ul>
        </nav>
    </div>

    <button class="toggle-btn">&#9776;</button>

    <div class="content">
          <div class="journal-editor">
    <div class="editor-container">
      <div class="typography-controls">
        <div class="control-box">
          <label for="fontSelect">Font:</label>
          <select id="fontSelect">
            <option value="Arial, sans-serif">Arial</option>
            <option value="'Courier New', monospace">Courier New</option>
            <option value="Georgia, serif">Georgia</option>
            <option value="'Times New Roman', serif">Times New Roman</option>
            <option value="Verdana, sans-serif">Verdana</option>
          </select>
        </div>

        <div class="control-box">
    <label for="entryType">Entry Type:</label>
    <select id="entryType">
      <option value="daily">Daily Reflection</option>
      <option value="gratitude">Gratitude</option>
      <option value="goals">Goals</option>
      <option value="dream">Dream Journal</option>
      <option value="freewrite">Free Write</option>
    </select>
  </div>

        <div class="control-box">
          <label for="fontSize">Font Size:</label>
          <input type="number" id="fontSize" value="16" min="12" max="30" step="1">
        </div>

        <div class="control-box">
          <label for="lineHeight">Line Spacing:</label>
          <input type="number" id="lineHeight" value="24" min="16" max="50" step="2">
        </div>
      </div>

      <textarea id="journalText" placeholder="Start writing your journal..."></textarea>
      <button id="saveButton">Save Journal</button>
    </div>
  </div>
    <script>
        const textarea = document.getElementById('journalText');
        const fontSelect = document.getElementById('fontSelect');
        const fontSizeInput = document.getElementById('fontSize');
        const lineHeightInput = document.getElementById('lineHeight');
        const sidebar = document.querySelector('.sidebar');
        const content = document.querySelector('.content');
        const toggleBtn = document.querySelector('.toggle-btn');
        const saveButton = document.getElementById('saveButton');

        fontSelect.addEventListener('change', () => {
            textarea.style.fontFamily = fontSelect.value;
        });

        fontSizeInput.addEventListener('input', () => {
            textarea.style.fontSize = fontSizeInput.value + 'px';
        });

        lineHeightInput.addEventListener('input', () => {
            textarea.style.lineHeight = lineHeightInput.value + 'px';
        });

        toggleBtn.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
            content.classList.toggle('collapsed');
            toggleBtn.classList.toggle('collapsed');
        });

        saveButton.addEventListener('click', () => {
          const journalText = textarea.value;
          const fontFamily = fontSelect.value;
          const fontSize = fontSizeInput.value + 'px';
          const lineHeight = lineHeightInput.value + 'px';

          fetch('/update_journal', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ 
              text: journalText, 
              fontFamily: fontFamily,
              fontSize: fontSize,
              lineHeight: lineHeight
             })
          })
          .then(response => response.json())
          .then(data => {
            if(data.status === 'success') {
              alert('Journal saved successfully!');
            } else {
              alert('Failed to save journal.');
            }
          })
          .catch(error => console.error('Error:', error));
        });
    </script>

</body>
</html>